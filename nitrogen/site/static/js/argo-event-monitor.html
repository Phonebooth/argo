<template>
    <style>
        .argo-event-monitor-container {
            margin-left: 20px;
            color: steelblue;
        }
        .container {
          padding-right: 15px;
          padding-left: 15px;
          margin-right: auto;
          margin-left: auto;
        }
        .container-fluid {
          padding-right: 15px;
          padding-left: 15px;
          margin-right: auto;
          margin-left: auto;
        }
        .row {
        }
        .col {
            display: inline;
            width: 33.33333333%;
            padding-right: 15px;
            padding-left: 15px;
        }
        .col3 {
            position: relative;
            min-height: 1px;
            float: left;
        }
        .btn {
          display: inline-block;
          padding: 6px 12px;
          margin-bottom: 0;
          font-size: 14px;
          font-weight: normal;
          line-height: 1.42857143;
          text-align: center;
          white-space: nowrap;
          vertical-align: middle;
          -ms-touch-action: manipulation;
              touch-action: manipulation;
          cursor: pointer;
          -webkit-user-select: none;
             -moz-user-select: none;
              -ms-user-select: none;
                  user-select: none;
          background-image: none;
          border: 1px solid transparent;
          border-radius: 4px;
        }
        .btn:focus,
        .btn:active:focus,
        .btn.active:focus,
        .btn.focus,
        .btn:active.focus,
        .btn.active.focus {
          outline: thin dotted;
          outline: 5px auto -webkit-focus-ring-color;
          outline-offset: -2px;
        }
        .btn:hover,
        .btn:focus,
        .btn.focus {
          color: #333;
          text-decoration: none;
        }
        .btn:active,
        .btn.active {
          background-image: none;
          outline: 0;
          -webkit-box-shadow: inset 0 3px 5px rgba(0, 0, 0, .125);
                  box-shadow: inset 0 3px 5px rgba(0, 0, 0, .125);
        }
        .btn.disabled,
        .btn[disabled],
        fieldset[disabled] .btn {
          cursor: not-allowed;
          filter: alpha(opacity=65);
          -webkit-box-shadow: none;
                  box-shadow: none;
          opacity: .65;
        }        
        .btn-primary {
            color: #fff;
            background-color: #337ab7;
            border-color: #2e6da4;
        }
    </style>
    <div class="argo-event-monitor-container">
        <div class="event-list container-fluid"></div>
    </div>
</template>
<script>
    (function() {

        var template = document._currentScript.ownerDocument.querySelector('template');
        var proto = Object.create(HTMLElement.prototype);

        proto.createdCallback = function() {
            var clone = document.importNode(template.content, true);
            this.createShadowRoot().appendChild(clone);
        };

        proto.attachedCallback = function() {
        };

        proto.attributeChangedCallback = function(attrName, oldVal, newVal) {
        };

        proto.updateData = function(data) {

            var l = this.shadowRoot.querySelector(".event-list");
            var body = "";

            $.each(data, function(index, element) {
                //console.log(element);
                body +=
                    "<div class=\"row\">" +
                    "<div class=\"col\">" +
                        element['node'] +
                    "</div>" +
                    "<div class=\"col\">" +
                        "<button type=\"button\" class=\"btn btn-primary\">" + 
                            element['label'] +
                        "</button>" +
                    "</div>" +
                    "<div class=\"col\">" +
                        (new Date(element['last_timestamp'])).toISOString() +
                    "</div>" +
                    "</div>";
            });

            l.innerHTML = body;
        };

        document.registerElement('argo-event-monitor', {prototype: proto});
    }());
</script>
